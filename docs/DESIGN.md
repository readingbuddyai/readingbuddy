# Reading Buddy 앱 디자인 계획서

## 개요
MyFitnessPal 앱의 UI/UX 패턴을 참고하여 Reading Buddy 앱의 화면을 재설계합니다.
현재 테마 컬러는 유지하며, 사용자 경험과 데이터 시각화를 개선합니다.

---

## 디자인 원칙

### 레퍼런스 앱에서 차용할 패턴
1. **카드 기반 레이아웃**: 정보를 카드 단위로 그룹화하여 가독성 향상
2. **스와이프 가능한 위젯**: 상단에 여러 요약 정보를 스와이프로 탐색
3. **2열 그리드**: 주요 메트릭을 2열로 배치하여 한눈에 파악
4. **차트 중심**: 학습 진행도를 시각적으로 표현
5. **일관된 헤더**: 프로필, 타이틀, 알림을 상단에 고정

### 제외할 요소
- 하단 탭바 중앙의 **+** 버튼 (필요 없음)

---

## 화면 구조

### 1. 하단 탭 네비게이션
```
┌─────────┬─────────┬─────────┬─────────┐
│  홈     │  학습   │  경과   │  프로필  │
│  🏠     │  📊     │  📈     │  ⚙️     │
└─────────┴─────────┴─────────┴─────────┘
```

- **홈**: 출석, 오늘의 학습 현황, 최근 활동
- **학습**: 스테이지별 분석, 음소 약점, 숙련도
- **경과**: 시간별 성장 추이, 출석 달력
- **프로필**: 사용자 정보, VR 연결, 설정

---

## 상세 화면 설계

### 🏠 홈 화면 (Home Screen)

#### 레이아웃
```
┌─────────────────────────────────────┐
│ 👤  Reading Buddy           🔔      │  ← 헤더
├─────────────────────────────────────┤
│ [스와이프 카드 영역]                 │
│ ○ ○ ● ○                             │  ← 페이지 인디케이터
│                                     │
│ 카드 1: 오늘의 출석 현황             │
│ 카드 2: 이번 주 학습 시간            │
│ 카드 3: 최근 학습 스테이지           │
├─────────────────────────────────────┤
│ ┌─────────────┐ ┌─────────────┐    │
│ │ 연속 출석   │ │ 오늘 학습   │    │  ← 2열 그리드
│ │   5일       │ │  15분       │    │
│ └─────────────┘ └─────────────┘    │
├─────────────────────────────────────┤
│ [최근 학습 정답률 그래프]            │
│  Stage 1.1.1: 85%                   │
│  ▓▓▓▓▓▓▓▓▓░░░░░░                    │
├─────────────────────────────────────┤
│ [빠른 액션]                          │
│ 🎮 VR 기기 연결                     │
│ ✓  오늘 출석 체크                   │
└─────────────────────────────────────┘
```

#### 사용 API
| 컴포넌트 | API | 설명 |
|---------|-----|------|
| 출석 현황 카드 | `GET /api/dashboard/attendance?date={today}` | 오늘 출석 여부, 학습 시간 |
| 주간 학습 시간 | `GET /api/dashboard/attendance?startdate={week_start}&enddate={today}` | 이번 주 총 학습 시간 |
| 연속 출석 일수 | `GET /api/dashboard/attendance?startdate={month_start}&enddate={today}` | 연속 출석 계산 |
| 최근 스테이지 정답률 | `GET /api/dashboard/stage/correct-rate?stage={last_stage}` | 가장 최근 플레이한 스테이지 |
| 출석 체크 버튼 | `POST /api/user/attend` | 출석 체크 실행 |

#### 주요 기능
- 출석 달력 미리보기 (탭하면 경과 화면으로 이동)
- 오늘의 학습 시간 표시 (mm:ss 형식)
- 최근 플레이한 스테이지의 정답률 표시
- 빠른 출석 체크 버튼
- VR 기기 연결 버튼

---

### 📊 학습 화면 (Analysis Screen)

#### 레이아웃
```
┌─────────────────────────────────────┐
│        학습 분석                     │  ← 헤더
├─────────────────────────────────────┤
│ [스테이지 선택 탭]                   │
│ ○ 1.1.1  ○ 1.1.2  ● 1.2.1  ○ 1.2.2 │
├─────────────────────────────────────┤
│ ┌─────────────┐ ┌─────────────┐    │
│ │ 평균 시도   │ │ 정답률      │    │  ← 선택된 스테이지 통계
│ │   3.5회     │ │   85%       │    │
│ └─────────────┘ └─────────────┘    │
├─────────────────────────────────────┤
│ [스테이지별 숙련도 - 원형 차트]      │
│         85%                         │
│      ●●●●●○○                        │
│   평균 숙련도                        │
├─────────────────────────────────────┤
│ 취약 음소 TOP 5                      │
│ 1. ㄱ  ▓▓▓▓▓░░░░░  15회 실수        │
│ 2. ㅏ  ▓▓▓▓░░░░░░  12회 실수        │
│ 3. ㅓ  ▓▓▓░░░░░░░  10회 실수        │
├─────────────────────────────────────┤
│ 많이 연습한 음소 TOP 5               │
│ 1. ㄱ  ▓▓▓▓▓▓▓░░░  50회 시도        │
│ 2. ㅏ  ▓▓▓▓▓▓░░░░  45회 시도        │
└─────────────────────────────────────┘
```

#### 사용 API
| 컴포넌트 | API | 설명 |
|---------|-----|------|
| 스테이지 통계 | `GET /api/dashboard/stage/info?stage={selected}` | 선택된 스테이지의 총 시도/정답/오답 |
| 평균 시도 횟수 | `GET /api/dashboard/stage/try-avg?stage={selected}` | 평균 시도 횟수 |
| 정답률 | `GET /api/dashboard/stage/correct-rate?stage={selected}` | 최근 세션 정답률 |
| 스테이지 숙련도 | `GET /api/dashboard/stage/mastery?stage={selected}` | KC별 숙련도 및 평균 |
| 취약 음소 | `GET /api/dashboard/mistake/phonemes/rank?limit=5` | 가장 많이 틀린 음소 |
| 연습 음소 | `GET /api/dashboard/try/phonemes/rank?limit=5` | 가장 많이 시도한 음소 |

#### 주요 기능
- 스테이지 선택 탭 (가로 스크롤)
- 선택된 스테이지의 상세 통계
- 원형 또는 게이지 차트로 숙련도 표시
- 음소 랭킹 (실수 많은 것 / 연습 많이 한 것)
- 각 음소 카드 탭 시 → KC 숙련도 추이 그래프 표시

---

### 📈 경과 화면 (Progress Screen)

#### 레이아웃
```
┌─────────────────────────────────────┐
│        경과                          │  ← 헤더
├─────────────────────────────────────┤
│ [탭 선택]                            │
│ ● 출석  ○ 학습시간  ○ 정답률        │
├─────────────────────────────────────┤
│ ┌─────────────────────────────┐    │
│ │  [출석 달력 - 월별]          │    │
│ │  Su Mo Tu We Th Fr Sa       │    │
│ │              1  2  3  4     │    │
│ │   5  6  ✓  ✓  ✓ ✓  11       │    │
│ │  12 13 14 15 16 17 18       │    │
│ │                             │    │
│ │  연속 출석: 5일              │    │
│ │  이달 출석: 7일              │    │
│ └─────────────────────────────┘    │
├─────────────────────────────────────┤
│ [학습 시간 그래프 - 주간]            │
│  40분 ┤                             │
│  30분 ┤        ▆                    │
│  20분 ┤    ▄   █   ▄                │
│  10분 ┤  ▂ █ ▆ █ ▂ █   ▂            │
│       └─────────────────            │
│        월 화 수 목 금 토 일          │
│                                     │
│  이번 주 총: 2시간 15분              │
│  일평균: 19분                        │
├─────────────────────────────────────┤
│ [정답률 추이 - 스테이지별]           │
│ 100% ┤                              │
│  80% ┤  ●───●───●                   │
│  60% ┤              ●───●           │
│  40% ┤                              │
│       └─────────────────            │
│       1.1.1  1.1.2  1.2.1           │
└─────────────────────────────────────┘
```

#### 사용 API
| 컴포넌트 | API | 설명 |
|---------|-----|------|
| 출석 달력 | `GET /api/dashboard/attendance?startdate={month_start}&enddate={month_end}` | 월별 출석 데이터 |
| 주간 학습 시간 | `GET /api/dashboard/attendance?startdate={week_start}&enddate={week_end}` | 일별 학습 시간 |
| 스테이지별 정답률 | 각 스테이지별로 `GET /api/dashboard/stage/correct-rate` 호출 | 여러 스테이지 정답률 비교 |

#### 주요 기능
- 탭으로 출석 / 학습시간 / 정답률 전환
- 출석 달력 (체크 표시)
- 막대 그래프로 일별 학습 시간
- 선 그래프로 스테이지별 정답률 추이
- 기간 선택 (주간/월간/전체)

---

### ⚙️ 프로필 화면 (Profile Screen)

#### 레이아웃
```
┌─────────────────────────────────────┐
│        프로필                        │  ← 헤더
├─────────────────────────────────────┤
│         ┌───────┐                   │
│         │  👤   │                   │
│         └───────┘                   │
│      사용자 닉네임                   │
│      user@email.com                 │
├─────────────────────────────────────┤
│ 📊 학습 요약                         │
│    총 학습 시간: 12시간 30분         │
│    총 출석 일수: 25일                │
│    연속 출석: 5일                    │
├─────────────────────────────────────┤
│ 🎮 VR 기기 연결                     │  → Device Auth 화면
│ 🎨 테마 설정                         │  → Theme 선택
│ 📢 알림 설정                         │
│ ℹ️  앱 정보                         │
│ 📝 이용약관                          │
│ 🔒 개인정보 처리방침                 │
├─────────────────────────────────────┤
│ [로그아웃]                           │
└─────────────────────────────────────┘
```

#### 사용 API
| 컴포넌트 | API | 설명 |
|---------|-----|------|
| 총 학습 시간 | `GET /api/dashboard/attendance?startdate={처음}&enddate={오늘}` | 전체 학습 시간 합계 |
| 총 출석 일수 | `GET /api/dashboard/attendance?startdate={처음}&enddate={오늘}` | 출석 일수 카운트 |
| 로그아웃 | 로컬 storage 정리 | - |

#### 주요 기능
- 사용자 정보 표시 (JWT 토큰에서 추출)
- 학습 요약 통계
- VR 기기 연결 (기존 Device Auth 화면 재사용)
- 테마 변경 (warm/cool/green)
- 로그아웃

---

## 컴포넌트 라이브러리

### 위젯 카드
```dart
// 스와이프 가능한 정보 카드
class InfoCard extends StatelessWidget {
  final String title;
  final String value;
  final IconData icon;
  final Color color;
}
```

### 통계 카드
```dart
// 2열 그리드용 메트릭 카드
class MetricCard extends StatelessWidget {
  final String label;
  final String value;
  final IconData icon;
}
```

### 차트 컴포넌트
- **LineChart**: 학습 시간 추이, 정답률 추이 (fl_chart 사용)
- **BarChart**: 일별 학습 시간 (fl_chart 사용)
- **CircularProgressChart**: 숙련도 표시
- **CalendarView**: 출석 달력 (table_calendar 사용)

### 리스트 아이템
```dart
// 음소 랭킹 아이템
class PhonemeRankItem extends StatelessWidget {
  final int rank;
  final String phoneme;
  final String category;
  final int count;
}
```

---

## 색상 시스템

### 현재 테마 유지
- **Warm**: 주황색 계열
- **Cool**: 파란색 계열
- **Green**: 초록색 계열

### 의미별 색상
- **Primary**: 테마 메인 색상
- **Success**: 정답, 높은 정답률 (초록)
- **Warning**: 평균 수준 (노랑)
- **Error**: 오답, 낮은 정답률 (빨강)
- **Surface**: 카드 배경 (어두운 회색)
- **Background**: 화면 배경 (검정에 가까운 회색)

---

## 애니메이션 및 인터랙션

### 카드 스와이프
- 가로 스와이프로 여러 정보 카드 탐색
- 부드러운 페이지 전환 애니메이션
- 페이지 인디케이터 표시

### 차트 애니메이션
- 차트 데이터 로드 시 부드러운 애니메이션
- 막대/선이 자라나는 효과

### 탭 전환
- 탭 선택 시 Fade + Slide 애니메이션
- 하단 탭바 아이콘 강조 효과

---

## 구현 우선순위

### Phase 1: 핵심 화면 (2주)
1. ✅ 로그인/회원가입 (완료)
2. 🏠 홈 화면 - 출석 현황, 기본 통계
3. 📊 학습 화면 - 스테이지 통계, 음소 랭킹
4. ⚙️ 프로필 화면 - 사용자 정보, 로그아웃

### Phase 2: 상세 기능 (2주)
5. 📈 경과 화면 - 출석 달력, 그래프
6. 스와이프 카드 구현
7. 차트 컴포넌트 구현 (fl_chart 연동)
8. KC 숙련도 추이 상세 화면

### Phase 3: 폴리싱 (1주)
9. 애니메이션 추가
10. 로딩 상태 처리
11. 에러 핸들링 개선
12. 다크 테마 최적화

---

## 기술 스택

### 현재 사용 중
- **상태관리**: Riverpod
- **라우팅**: go_router
- **네트워킹**: Dio + Retrofit
- **로컬 저장소**: flutter_secure_storage, shared_preferences

### 추가 필요
- **차트**: fl_chart (이미 pubspec.yaml에 있음)
- **달력**: table_calendar (이미 pubspec.yaml에 있음)
- **스와이프**: PageView (Flutter 기본 제공)

---

## 데이터 흐름

### 홈 화면 로딩
```
1. 사용자 로그인 상태 확인
2. 병렬로 여러 API 호출:
   - 오늘 출석 데이터
   - 이번 주 출석 데이터
   - 최근 스테이지 정답률
3. 데이터 수신 완료되면 위젯 렌더링
4. 각 카드는 독립적으로 로딩/에러 처리
```

### 학습 화면 로딩
```
1. 기본 스테이지(1.1.1) 선택 상태로 시작
2. 해당 스테이지 API 호출:
   - 스테이지 통계
   - 평균 시도 횟수
   - 정답률
   - 숙련도
3. 음소 랭킹 API 호출 (전체 데이터)
4. 스테이지 변경 시 → 해당 스테이지 데이터만 다시 로드
```

### 경과 화면 로딩
```
1. 기본 탭(출석) 선택
2. 현재 월의 출석 데이터 로드
3. 탭 전환 시 → 해당 탭 데이터 로드
4. 기간 변경 시 → 새로운 기간 데이터 로드
```

---

## 성능 최적화

### 캐싱 전략
- 홈 화면 데이터: 5분 캐시
- 학습 통계: 10분 캐시
- 경과 데이터: 30분 캐시

### 지연 로딩
- 차트는 화면에 보일 때만 렌더링
- 이미지/아이콘은 지연 로드

### API 최적화
- 병렬 호출로 로딩 시간 단축
- 불필요한 재호출 방지 (Riverpod 캐싱)

---

## 다음 단계

1. ✅ 이 문서 작성 완료
2. 각 화면별 Riverpod Provider 설계
3. 위젯 컴포넌트 라이브러리 구현
4. 화면별 순차 구현 (Phase 1 → 2 → 3)
5. 사용자 피드백 수집 및 개선

---

## 참고사항

- MyFitnessPal의 UI 패턴을 차용하되, Reading Buddy의 도메인(한글 학습)에 맞게 조정
- 기존 warm/cool/green 테마는 유지
- VR 기기 연동은 핵심 기능이므로 접근성 좋게 배치
- 출석 체크는 게이미피케이션 요소로 강조
- 음소/KC 숙련도는 학습 효과 측정의 핵심이므로 시각화에 집중
